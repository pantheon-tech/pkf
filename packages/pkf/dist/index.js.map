{"version":3,"sources":["../src/commands/init.ts","../src/commands/validate.ts","../src/commands/status.ts"],"sourcesContent":["/**\r\n * Init Command\r\n * Scaffolds PKF in a new or existing project\r\n */\r\n\r\nimport { existsSync, mkdirSync, writeFileSync, copyFileSync } from 'node:fs';\r\nimport { join, dirname } from 'node:path';\r\nimport { fileURLToPath } from 'node:url';\r\nimport chalk from 'chalk';\r\n\r\nconst __dirname = dirname(fileURLToPath(import.meta.url));\r\n\r\ninterface InitOptions {\r\n  yes?: boolean;\r\n  template?: 'minimal' | 'standard' | 'full';\r\n}\r\n\r\nconst TEMPLATES = {\r\n  minimal: {\r\n    description: 'Basic PKF setup with essential files only',\r\n    files: ['pkf.config.yaml', 'docs/README.md', 'docs/registers/TODO.md'],\r\n  },\r\n  standard: {\r\n    description: 'Standard PKF setup with guides and registers',\r\n    files: [\r\n      'pkf.config.yaml',\r\n      'CLAUDE.md',\r\n      'docs/README.md',\r\n      'docs/INDEX',\r\n      'docs/guides/README.md',\r\n      'docs/registers/README.md',\r\n      'docs/registers/TODO.md',\r\n      'docs/registers/ISSUES.md',\r\n      'docs/registers/CHANGELOG.md',\r\n    ],\r\n  },\r\n  full: {\r\n    description: 'Full PKF setup with all directories and lifecycle support',\r\n    files: [\r\n      'pkf.config.yaml',\r\n      'CLAUDE.md',\r\n      'docs/README.md',\r\n      'docs/INDEX',\r\n      'docs/guides/README.md',\r\n      'docs/guides/INDEX',\r\n      'docs/architecture/README.md',\r\n      'docs/architecture/active/README.md',\r\n      'docs/architecture/archived/README.md',\r\n      'docs/proposals/README.md',\r\n      'docs/proposals/draft/README.md',\r\n      'docs/proposals/active/README.md',\r\n      'docs/proposals/archived/README.md',\r\n      'docs/registers/README.md',\r\n      'docs/registers/TODO.md',\r\n      'docs/registers/ISSUES.md',\r\n      'docs/registers/CHANGELOG.md',\r\n    ],\r\n  },\r\n};\r\n\r\nexport async function initCommand(options: InitOptions): Promise<void> {\r\n  const template = options.template || 'standard';\r\n  const cwd = process.cwd();\r\n\r\n  console.log(chalk.bold('\\nPKF - Project Knowledge Framework\\n'));\r\n\r\n  // Check if PKF is already initialized\r\n  if (existsSync(join(cwd, 'pkf.config.yaml'))) {\r\n    console.log(chalk.yellow('⚠ PKF is already initialized in this project.'));\r\n    console.log(chalk.gray('  To reinitialize, remove pkf.config.yaml first.\\n'));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.cyan(`Initializing PKF with ${chalk.bold(template)} template...\\n`));\r\n  console.log(chalk.gray(`  ${TEMPLATES[template as keyof typeof TEMPLATES].description}\\n`));\r\n\r\n  // Create directories and files\r\n  const files = TEMPLATES[template as keyof typeof TEMPLATES].files;\r\n  let created = 0;\r\n\r\n  for (const file of files) {\r\n    const filePath = join(cwd, file);\r\n    const dir = dirname(filePath);\r\n\r\n    // Create directory if needed\r\n    if (!existsSync(dir)) {\r\n      mkdirSync(dir, { recursive: true });\r\n    }\r\n\r\n    // Create file with template content\r\n    if (!existsSync(filePath)) {\r\n      const content = getTemplateContent(file, cwd);\r\n      writeFileSync(filePath, content);\r\n      console.log(chalk.green(`  ✓ Created ${file}`));\r\n      created++;\r\n    } else {\r\n      console.log(chalk.gray(`  - Skipped ${file} (already exists)`));\r\n    }\r\n  }\r\n\r\n  console.log(chalk.bold.green(`\\n✓ PKF initialized successfully!`));\r\n  console.log(chalk.gray(`  Created ${created} files\\n`));\r\n\r\n  console.log(chalk.bold('Next steps:'));\r\n  console.log(chalk.gray('  1. Edit pkf.config.yaml to customize your documentation structure'));\r\n  console.log(chalk.gray('  2. Run `pkf build` to generate validation artifacts'));\r\n  console.log(chalk.gray('  3. Run `pkf validate` to check your documentation\\n'));\r\n}\r\n\r\nfunction getTemplateContent(file: string, cwd: string): string {\r\n  const projectName = cwd.split('/').pop() || 'my-project';\r\n\r\n  if (file === 'pkf.config.yaml') {\r\n    return `# PKF Configuration\r\n# Documentation: https://github.com/anthropics/pkf\r\n\r\nversion: \"1.0.0\"\r\n\r\nproject:\r\n  name: ${projectName}\r\n  description: Project documentation\r\n\r\noutput:\r\n  dir: .pkf/generated\r\n\r\ndocs:\r\n  _type: root\r\n  _readme: true\r\n  _index: true\r\n\r\n  guides:\r\n    _type: section\r\n    _readme: true\r\n\r\n  registers:\r\n    _type: registers\r\n    _readme: true\r\n    _items:\r\n      TODO.md:\r\n        _schema: todo-item\r\n      ISSUES.md:\r\n        _schema: issue-item\r\n      CHANGELOG.md:\r\n        _schema: changelog-entry\r\n`;\r\n  }\r\n\r\n  if (file === 'CLAUDE.md') {\r\n    return `# CLAUDE.md\r\n\r\nThis file provides guidance to Claude Code when working with this repository.\r\n\r\n## Project Overview\r\n\r\n**Project:** ${projectName}\r\n**Version:** 1.0.0\r\n**Status:** Active\r\n\r\n## Quick Start\r\n\r\n\\`\\`\\`bash\r\n# Install dependencies\r\nnpm install\r\n\r\n# Run validation\r\nnpx pkf validate\r\n\\`\\`\\`\r\n\r\n## Key Files\r\n\r\n- \\`pkf.config.yaml\\` - PKF configuration\r\n- \\`docs/\\` - Documentation root\r\n\r\n## Registers\r\n\r\n- \\`docs/registers/TODO.md\\` - Pending tasks\r\n- \\`docs/registers/ISSUES.md\\` - Known issues\r\n- \\`docs/registers/CHANGELOG.md\\` - Version history\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file === 'docs/README.md') {\r\n    return `# ${projectName} Documentation\r\n\r\nWelcome to the ${projectName} documentation.\r\n\r\n## Contents\r\n\r\n- [Guides](./guides/) - How-to guides and tutorials\r\n- [Registers](./registers/) - TODO, ISSUES, CHANGELOG\r\n\r\n## Quick Links\r\n\r\n- [TODO](./registers/TODO.md) - Current tasks\r\n- [CHANGELOG](./registers/CHANGELOG.md) - Version history\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file === 'docs/INDEX') {\r\n    return `# Documentation Index\r\n\r\nREADME.md: Documentation hub\r\nguides/: How-to guides and tutorials\r\nregisters/: Project registers (TODO, ISSUES, CHANGELOG)\r\n`;\r\n  }\r\n\r\n  if (file.includes('registers/TODO.md')) {\r\n    return `# TODO\r\n\r\n## Quick Stats\r\n\r\n- **Total Items:** 0\r\n- **Pending:** 0\r\n- **In Progress:** 0\r\n- **Completed:** 0\r\n\r\n## Pending\r\n\r\n_No pending items._\r\n\r\n## In Progress\r\n\r\n_No items in progress._\r\n\r\n## Completed\r\n\r\n_No completed items._\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file.includes('registers/ISSUES.md')) {\r\n    return `# Known Issues\r\n\r\n## Quick Stats\r\n\r\n- **Total Issues:** 0\r\n- **Open:** 0\r\n- **Resolved:** 0\r\n\r\n## Open Issues\r\n\r\n_No open issues._\r\n\r\n## Resolved Issues\r\n\r\n_No resolved issues._\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file.includes('registers/CHANGELOG.md')) {\r\n    return `# Changelog\r\n\r\nAll notable changes to this project will be documented in this file.\r\n\r\nThe format is based on [Keep a Changelog](https://keepachangelog.com/),\r\nand this project adheres to [Semantic Versioning](https://semver.org/).\r\n\r\n## [Unreleased]\r\n\r\n### Added\r\n- Initial project setup\r\n- PKF documentation framework\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file.includes('README.md')) {\r\n    const section = file.split('/')[1];\r\n    return `# ${section.charAt(0).toUpperCase() + section.slice(1)}\r\n\r\nThis directory contains ${section} documentation.\r\n\r\n---\r\n\r\n**Last Updated:** ${new Date().toISOString().split('T')[0]}\r\n`;\r\n  }\r\n\r\n  if (file.includes('INDEX')) {\r\n    return `# Index\r\n\r\nREADME.md: Section overview\r\n`;\r\n  }\r\n\r\n  return `# ${file}\\n\\nPlaceholder content.\\n`;\r\n}\r\n","/**\r\n * Validate Command\r\n * Runs all PKF validations\r\n */\r\n\r\nimport { existsSync, readFileSync, readdirSync } from 'node:fs';\r\nimport { join, extname } from 'node:path';\r\nimport { spawn, execSync } from 'node:child_process';\r\nimport chalk from 'chalk';\r\n\r\ninterface ValidateOptions {\r\n  config?: string;\r\n  structure?: boolean;\r\n  content?: boolean;\r\n  fix?: boolean;\r\n}\r\n\r\ninterface ValidationResult {\r\n  category: string;\r\n  errors: number;\r\n  warnings: number;\r\n  messages: string[];\r\n}\r\n\r\nexport async function validateCommand(options: ValidateOptions): Promise<void> {\r\n  const cwd = process.cwd();\r\n  const configPath = options.config || 'pkf.config.yaml';\r\n  const structurePath = join(cwd, '.pkf/generated/structure.json');\r\n\r\n  console.log(chalk.bold('\\nPKF Validate\\n'));\r\n\r\n  // Check if PKF is initialized\r\n  if (!existsSync(join(cwd, configPath))) {\r\n    console.log(chalk.red(`✗ PKF not initialized in this project`));\r\n    console.log(chalk.gray('  Run `pkf init` to initialize PKF.\\n'));\r\n    process.exit(1);\r\n  }\r\n\r\n  // Check if build artifacts exist\r\n  if (!existsSync(structurePath)) {\r\n    console.log(chalk.yellow('⚠ Build artifacts not found. Running build first...\\n'));\r\n    const { buildCommand } = await import('./build.js');\r\n    await buildCommand({ config: configPath });\r\n    console.log('');\r\n  }\r\n\r\n  const results: ValidationResult[] = [];\r\n  let totalErrors = 0;\r\n  let totalWarnings = 0;\r\n\r\n  // Run structure validation\r\n  if (!options.content) {\r\n    console.log(chalk.cyan('Validating structure...'));\r\n    const structureResult = await validateStructure(cwd, structurePath);\r\n    results.push(structureResult);\r\n    totalErrors += structureResult.errors;\r\n    totalWarnings += structureResult.warnings;\r\n  }\r\n\r\n  // Run content validation\r\n  if (!options.structure) {\r\n    console.log(chalk.cyan('Validating content...'));\r\n    const contentResult = await validateContent(cwd);\r\n    results.push(contentResult);\r\n    totalErrors += contentResult.errors;\r\n    totalWarnings += contentResult.warnings;\r\n  }\r\n\r\n  // Print results\r\n  console.log(chalk.bold('\\nValidation Summary:\\n'));\r\n\r\n  for (const result of results) {\r\n    const status = result.errors > 0\r\n      ? chalk.red('✗')\r\n      : result.warnings > 0\r\n        ? chalk.yellow('⚠')\r\n        : chalk.green('✓');\r\n\r\n    console.log(`${status} ${chalk.bold(result.category)}`);\r\n    console.log(chalk.gray(`  Errors: ${result.errors}, Warnings: ${result.warnings}`));\r\n\r\n    for (const msg of result.messages.slice(0, 5)) {\r\n      console.log(chalk.gray(`  - ${msg}`));\r\n    }\r\n\r\n    if (result.messages.length > 5) {\r\n      console.log(chalk.gray(`  ... and ${result.messages.length - 5} more`));\r\n    }\r\n    console.log('');\r\n  }\r\n\r\n  // Final status\r\n  console.log(chalk.bold('─'.repeat(40)));\r\n  if (totalErrors > 0) {\r\n    console.log(chalk.red.bold(`\\n✗ Validation failed`));\r\n    console.log(chalk.gray(`  ${totalErrors} error(s), ${totalWarnings} warning(s)\\n`));\r\n    process.exit(1);\r\n  } else if (totalWarnings > 0) {\r\n    console.log(chalk.yellow.bold(`\\n⚠ Validation passed with warnings`));\r\n    console.log(chalk.gray(`  ${totalWarnings} warning(s)\\n`));\r\n  } else {\r\n    console.log(chalk.green.bold(`\\n✓ All validations passed\\n`));\r\n  }\r\n}\r\n\r\nasync function validateStructure(cwd: string, structurePath: string): Promise<ValidationResult> {\r\n  const result: ValidationResult = {\r\n    category: 'Structure',\r\n    errors: 0,\r\n    warnings: 0,\r\n    messages: [],\r\n  };\r\n\r\n  // Find pkf-processor CLI\r\n  const pkfProcessorPaths = [\r\n    join(cwd, 'node_modules/.bin/pkf-processor'),\r\n    join(cwd, 'node_modules/@pantheon-tech/pkf-processor/dist/cli.js'),\r\n  ];\r\n\r\n  let pkfProcessorPath: string | null = null;\r\n  for (const p of pkfProcessorPaths) {\r\n    if (existsSync(p)) {\r\n      pkfProcessorPath = p;\r\n      break;\r\n    }\r\n  }\r\n\r\n  if (pkfProcessorPath) {\r\n    try {\r\n      const isJsFile = pkfProcessorPath.endsWith('.js');\r\n      const command = isJsFile ? `node ${pkfProcessorPath}` : pkfProcessorPath;\r\n\r\n      const output = execSync(`${command} validate-structure --structure ${structurePath} 2>&1`, {\r\n        cwd,\r\n        encoding: 'utf8',\r\n      });\r\n\r\n      // Parse output\r\n      const errorsMatch = output.match(/Errors:\\s+(\\d+)/);\r\n      const warningsMatch = output.match(/Warnings:\\s+(\\d+)/);\r\n\r\n      result.errors = errorsMatch ? parseInt(errorsMatch[1], 10) : 0;\r\n      result.warnings = warningsMatch ? parseInt(warningsMatch[1], 10) : 0;\r\n\r\n      // Extract messages\r\n      const errorLines = output.match(/ERROR \\[.*?\\] (.*)/g);\r\n      const warningLines = output.match(/WARNING \\[.*?\\] (.*)/g);\r\n\r\n      if (errorLines) {\r\n        result.messages.push(...errorLines.map(l => l.replace(/ERROR \\[.*?\\] /, '')));\r\n      }\r\n      if (warningLines) {\r\n        result.messages.push(...warningLines.map(l => l.replace(/WARNING \\[.*?\\] /, '')));\r\n      }\r\n    } catch (error: any) {\r\n      const output = error.stdout || error.stderr || '';\r\n      const errorsMatch = output.match(/Errors:\\s+(\\d+)/);\r\n      const warningsMatch = output.match(/Warnings:\\s+(\\d+)/);\r\n\r\n      result.errors = errorsMatch ? parseInt(errorsMatch[1], 10) : 1;\r\n      result.warnings = warningsMatch ? parseInt(warningsMatch[1], 10) : 0;\r\n\r\n      const errorLines = output.match(/ERROR \\[.*?\\] (.*)/g);\r\n      if (errorLines) {\r\n        result.messages.push(...errorLines.map((l: string) => l.replace(/ERROR \\[.*?\\] /, '')));\r\n      }\r\n    }\r\n  } else {\r\n    // Fallback: basic structure check\r\n    const docsDir = join(cwd, 'docs');\r\n    if (!existsSync(docsDir)) {\r\n      result.errors++;\r\n      result.messages.push('docs/ directory not found');\r\n    }\r\n\r\n    const readmeFile = join(docsDir, 'README.md');\r\n    if (existsSync(docsDir) && !existsSync(readmeFile)) {\r\n      result.errors++;\r\n      result.messages.push('docs/README.md not found');\r\n    }\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nasync function validateContent(cwd: string): Promise<ValidationResult> {\r\n  const result: ValidationResult = {\r\n    category: 'Content',\r\n    errors: 0,\r\n    warnings: 0,\r\n    messages: [],\r\n  };\r\n\r\n  const docsDir = join(cwd, 'docs');\r\n  if (!existsSync(docsDir)) {\r\n    return result;\r\n  }\r\n\r\n  // Check markdown files for basic issues\r\n  const checkDir = (dir: string) => {\r\n    try {\r\n      const files = readdirSync(dir, { withFileTypes: true });\r\n      for (const file of files) {\r\n        const filePath = join(dir, file.name);\r\n        if (file.isDirectory()) {\r\n          checkDir(filePath);\r\n        } else if (extname(file.name) === '.md') {\r\n          const content = readFileSync(filePath, 'utf8');\r\n          const relativePath = filePath.replace(cwd + '/', '');\r\n\r\n          // Check for title\r\n          if (!content.match(/^#\\s+/m)) {\r\n            result.warnings++;\r\n            result.messages.push(`${relativePath}: Missing title heading`);\r\n          }\r\n\r\n          // Check for empty file\r\n          if (content.trim().length === 0) {\r\n            result.errors++;\r\n            result.messages.push(`${relativePath}: Empty file`);\r\n          }\r\n\r\n          // Check for broken internal links\r\n          const linkPattern = /\\[([^\\]]+)\\]\\(([^)]+)\\)/g;\r\n          let match;\r\n          while ((match = linkPattern.exec(content)) !== null) {\r\n            const linkPath = match[2];\r\n            if (!linkPath.startsWith('http') && !linkPath.startsWith('#')) {\r\n              const resolvedPath = join(dir, linkPath);\r\n              if (!existsSync(resolvedPath)) {\r\n                result.warnings++;\r\n                result.messages.push(`${relativePath}: Broken link to ${linkPath}`);\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    } catch {\r\n      // Ignore read errors\r\n    }\r\n  };\r\n\r\n  checkDir(docsDir);\r\n\r\n  return result;\r\n}\r\n","/**\r\n * Status Command\r\n * Shows PKF status in current project\r\n */\r\n\r\nimport { existsSync, readFileSync, statSync } from 'node:fs';\r\nimport { join } from 'node:path';\r\nimport chalk from 'chalk';\r\n\r\nexport async function statusCommand(): Promise<void> {\r\n  const cwd = process.cwd();\r\n\r\n  console.log(chalk.bold('\\nPKF Status\\n'));\r\n\r\n  // Check initialization\r\n  const configPath = join(cwd, 'pkf.config.yaml');\r\n  const isInitialized = existsSync(configPath);\r\n\r\n  if (!isInitialized) {\r\n    console.log(chalk.yellow('⚠ PKF is not initialized in this project\\n'));\r\n    console.log(chalk.gray('  Run `pkf init` to get started.\\n'));\r\n    return;\r\n  }\r\n\r\n  console.log(chalk.green('✓ PKF initialized\\n'));\r\n\r\n  // Parse config\r\n  try {\r\n    const configContent = readFileSync(configPath, 'utf8');\r\n    const versionMatch = configContent.match(/version:\\s*[\"']?([^\"'\\n]+)[\"']?/);\r\n    const nameMatch = configContent.match(/name:\\s*[\"']?([^\"'\\n]+)[\"']?/);\r\n\r\n    console.log(chalk.bold('Configuration:'));\r\n    console.log(chalk.gray(`  Project: ${nameMatch?.[1] || 'Unknown'}`));\r\n    console.log(chalk.gray(`  Version: ${versionMatch?.[1] || 'Unknown'}`));\r\n    console.log(chalk.gray(`  Config:  ${configPath}`));\r\n    console.log('');\r\n  } catch {\r\n    console.log(chalk.yellow('  Could not parse configuration\\n'));\r\n  }\r\n\r\n  // Check build artifacts\r\n  const buildDir = join(cwd, '.pkf/generated');\r\n  const structurePath = join(buildDir, 'structure.json');\r\n  const hasBuildArtifacts = existsSync(structurePath);\r\n\r\n  console.log(chalk.bold('Build Status:'));\r\n  if (hasBuildArtifacts) {\r\n    const stats = statSync(structurePath);\r\n    const lastBuild = stats.mtime.toLocaleString();\r\n    console.log(chalk.green(`  ✓ Build artifacts present`));\r\n    console.log(chalk.gray(`    Last build: ${lastBuild}`));\r\n  } else {\r\n    console.log(chalk.yellow(`  ⚠ No build artifacts found`));\r\n    console.log(chalk.gray(`    Run \\`pkf build\\` to generate`));\r\n  }\r\n  console.log('');\r\n\r\n  // Check documentation structure\r\n  const docsDir = join(cwd, 'docs');\r\n  const hasDocsDir = existsSync(docsDir);\r\n\r\n  console.log(chalk.bold('Documentation:'));\r\n  if (hasDocsDir) {\r\n    const readmePath = join(docsDir, 'README.md');\r\n    const hasReadme = existsSync(readmePath);\r\n\r\n    console.log(chalk.green(`  ✓ docs/ directory exists`));\r\n    console.log(hasReadme\r\n      ? chalk.green(`  ✓ docs/README.md present`)\r\n      : chalk.yellow(`  ⚠ docs/README.md missing`));\r\n\r\n    // Check registers\r\n    const registersDir = join(docsDir, 'registers');\r\n    if (existsSync(registersDir)) {\r\n      const todo = existsSync(join(registersDir, 'TODO.md'));\r\n      const issues = existsSync(join(registersDir, 'ISSUES.md'));\r\n      const changelog = existsSync(join(registersDir, 'CHANGELOG.md'));\r\n\r\n      console.log(chalk.gray(`  Registers:`));\r\n      console.log(todo\r\n        ? chalk.green(`    ✓ TODO.md`)\r\n        : chalk.gray(`    - TODO.md (missing)`));\r\n      console.log(issues\r\n        ? chalk.green(`    ✓ ISSUES.md`)\r\n        : chalk.gray(`    - ISSUES.md (missing)`));\r\n      console.log(changelog\r\n        ? chalk.green(`    ✓ CHANGELOG.md`)\r\n        : chalk.gray(`    - CHANGELOG.md (missing)`));\r\n    }\r\n  } else {\r\n    console.log(chalk.yellow(`  ⚠ docs/ directory not found`));\r\n  }\r\n  console.log('');\r\n\r\n  // Check CLAUDE.md\r\n  const claudePath = join(cwd, 'CLAUDE.md');\r\n  const hasClaudeMd = existsSync(claudePath);\r\n\r\n  console.log(chalk.bold('AI Integration:'));\r\n  console.log(hasClaudeMd\r\n    ? chalk.green(`  ✓ CLAUDE.md present`)\r\n    : chalk.gray(`  - CLAUDE.md not found (optional)`));\r\n  console.log('');\r\n\r\n  // Summary\r\n  console.log(chalk.bold('─'.repeat(40)));\r\n  console.log(chalk.gray('\\nRun `pkf validate` for detailed validation.\\n'));\r\n}\r\n"],"mappings":";;;;;AAKA,SAAS,YAAY,WAAW,qBAAmC;AACnE,SAAS,MAAM,eAAe;AAC9B,SAAS,qBAAqB;AAC9B,OAAO,WAAW;AAElB,IAAM,YAAY,QAAQ,cAAc,YAAY,GAAG,CAAC;AAOxD,IAAM,YAAY;AAAA,EAChB,SAAS;AAAA,IACP,aAAa;AAAA,IACb,OAAO,CAAC,mBAAmB,kBAAkB,wBAAwB;AAAA,EACvE;AAAA,EACA,UAAU;AAAA,IACR,aAAa;AAAA,IACb,OAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA,EACA,MAAM;AAAA,IACJ,aAAa;AAAA,IACb,OAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AACF;AAEA,eAAsB,YAAY,SAAqC;AACrE,QAAM,WAAW,QAAQ,YAAY;AACrC,QAAM,MAAM,QAAQ,IAAI;AAExB,UAAQ,IAAI,MAAM,KAAK,uCAAuC,CAAC;AAG/D,MAAI,WAAW,KAAK,KAAK,iBAAiB,CAAC,GAAG;AAC5C,YAAQ,IAAI,MAAM,OAAO,oDAA+C,CAAC;AACzE,YAAQ,IAAI,MAAM,KAAK,oDAAoD,CAAC;AAC5E;AAAA,EACF;AAEA,UAAQ,IAAI,MAAM,KAAK,yBAAyB,MAAM,KAAK,QAAQ,CAAC;AAAA,CAAgB,CAAC;AACrF,UAAQ,IAAI,MAAM,KAAK,KAAK,UAAU,QAAkC,EAAE,WAAW;AAAA,CAAI,CAAC;AAG1F,QAAM,QAAQ,UAAU,QAAkC,EAAE;AAC5D,MAAI,UAAU;AAEd,aAAW,QAAQ,OAAO;AACxB,UAAM,WAAW,KAAK,KAAK,IAAI;AAC/B,UAAM,MAAM,QAAQ,QAAQ;AAG5B,QAAI,CAAC,WAAW,GAAG,GAAG;AACpB,gBAAU,KAAK,EAAE,WAAW,KAAK,CAAC;AAAA,IACpC;AAGA,QAAI,CAAC,WAAW,QAAQ,GAAG;AACzB,YAAM,UAAU,mBAAmB,MAAM,GAAG;AAC5C,oBAAc,UAAU,OAAO;AAC/B,cAAQ,IAAI,MAAM,MAAM,oBAAe,IAAI,EAAE,CAAC;AAC9C;AAAA,IACF,OAAO;AACL,cAAQ,IAAI,MAAM,KAAK,eAAe,IAAI,mBAAmB,CAAC;AAAA,IAChE;AAAA,EACF;AAEA,UAAQ,IAAI,MAAM,KAAK,MAAM;AAAA,qCAAmC,CAAC;AACjE,UAAQ,IAAI,MAAM,KAAK,aAAa,OAAO;AAAA,CAAU,CAAC;AAEtD,UAAQ,IAAI,MAAM,KAAK,aAAa,CAAC;AACrC,UAAQ,IAAI,MAAM,KAAK,qEAAqE,CAAC;AAC7F,UAAQ,IAAI,MAAM,KAAK,uDAAuD,CAAC;AAC/E,UAAQ,IAAI,MAAM,KAAK,uDAAuD,CAAC;AACjF;AAEA,SAAS,mBAAmB,MAAc,KAAqB;AAC7D,QAAM,cAAc,IAAI,MAAM,GAAG,EAAE,IAAI,KAAK;AAE5C,MAAI,SAAS,mBAAmB;AAC9B,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAMD,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EA0BnB;AAEA,MAAI,SAAS,aAAa;AACxB,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAMI,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBA2BN,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,SAAS,kBAAkB;AAC7B,WAAO,KAAK,WAAW;AAAA;AAAA,iBAEV,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAcR,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,SAAS,cAAc;AACzB,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMT;AAEA,MAAI,KAAK,SAAS,mBAAmB,GAAG;AACtC,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAuBS,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,KAAK,SAAS,qBAAqB,GAAG;AACxC,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAkBS,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,KAAK,SAAS,wBAAwB,GAAG;AAC3C,WAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAeS,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,KAAK,SAAS,WAAW,GAAG;AAC9B,UAAM,UAAU,KAAK,MAAM,GAAG,EAAE,CAAC;AACjC,WAAO,KAAK,QAAQ,OAAO,CAAC,EAAE,YAAY,IAAI,QAAQ,MAAM,CAAC,CAAC;AAAA;AAAA,0BAExC,OAAO;AAAA;AAAA;AAAA;AAAA,qBAIb,oBAAI,KAAK,GAAE,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC,CAAC;AAAA;AAAA,EAExD;AAEA,MAAI,KAAK,SAAS,OAAO,GAAG;AAC1B,WAAO;AAAA;AAAA;AAAA;AAAA,EAIT;AAEA,SAAO,KAAK,IAAI;AAAA;AAAA;AAAA;AAClB;;;AC7SA,SAAS,cAAAA,aAAY,cAAc,mBAAmB;AACtD,SAAS,QAAAC,OAAM,eAAe;AAC9B,SAAgB,gBAAgB;AAChC,OAAOC,YAAW;AAgBlB,eAAsB,gBAAgB,SAAyC;AAC7E,QAAM,MAAM,QAAQ,IAAI;AACxB,QAAM,aAAa,QAAQ,UAAU;AACrC,QAAM,gBAAgBD,MAAK,KAAK,+BAA+B;AAE/D,UAAQ,IAAIC,OAAM,KAAK,kBAAkB,CAAC;AAG1C,MAAI,CAACF,YAAWC,MAAK,KAAK,UAAU,CAAC,GAAG;AACtC,YAAQ,IAAIC,OAAM,IAAI,4CAAuC,CAAC;AAC9D,YAAQ,IAAIA,OAAM,KAAK,uCAAuC,CAAC;AAC/D,YAAQ,KAAK,CAAC;AAAA,EAChB;AAGA,MAAI,CAACF,YAAW,aAAa,GAAG;AAC9B,YAAQ,IAAIE,OAAM,OAAO,4DAAuD,CAAC;AACjF,UAAM,EAAE,cAAAC,cAAa,IAAI,MAAM,OAAO,qBAAY;AAClD,UAAMA,cAAa,EAAE,QAAQ,WAAW,CAAC;AACzC,YAAQ,IAAI,EAAE;AAAA,EAChB;AAEA,QAAM,UAA8B,CAAC;AACrC,MAAI,cAAc;AAClB,MAAI,gBAAgB;AAGpB,MAAI,CAAC,QAAQ,SAAS;AACpB,YAAQ,IAAID,OAAM,KAAK,yBAAyB,CAAC;AACjD,UAAM,kBAAkB,MAAM,kBAAkB,KAAK,aAAa;AAClE,YAAQ,KAAK,eAAe;AAC5B,mBAAe,gBAAgB;AAC/B,qBAAiB,gBAAgB;AAAA,EACnC;AAGA,MAAI,CAAC,QAAQ,WAAW;AACtB,YAAQ,IAAIA,OAAM,KAAK,uBAAuB,CAAC;AAC/C,UAAM,gBAAgB,MAAM,gBAAgB,GAAG;AAC/C,YAAQ,KAAK,aAAa;AAC1B,mBAAe,cAAc;AAC7B,qBAAiB,cAAc;AAAA,EACjC;AAGA,UAAQ,IAAIA,OAAM,KAAK,yBAAyB,CAAC;AAEjD,aAAW,UAAU,SAAS;AAC5B,UAAM,SAAS,OAAO,SAAS,IAC3BA,OAAM,IAAI,QAAG,IACb,OAAO,WAAW,IAChBA,OAAM,OAAO,QAAG,IAChBA,OAAM,MAAM,QAAG;AAErB,YAAQ,IAAI,GAAG,MAAM,IAAIA,OAAM,KAAK,OAAO,QAAQ,CAAC,EAAE;AACtD,YAAQ,IAAIA,OAAM,KAAK,aAAa,OAAO,MAAM,eAAe,OAAO,QAAQ,EAAE,CAAC;AAElF,eAAW,OAAO,OAAO,SAAS,MAAM,GAAG,CAAC,GAAG;AAC7C,cAAQ,IAAIA,OAAM,KAAK,OAAO,GAAG,EAAE,CAAC;AAAA,IACtC;AAEA,QAAI,OAAO,SAAS,SAAS,GAAG;AAC9B,cAAQ,IAAIA,OAAM,KAAK,aAAa,OAAO,SAAS,SAAS,CAAC,OAAO,CAAC;AAAA,IACxE;AACA,YAAQ,IAAI,EAAE;AAAA,EAChB;AAGA,UAAQ,IAAIA,OAAM,KAAK,SAAI,OAAO,EAAE,CAAC,CAAC;AACtC,MAAI,cAAc,GAAG;AACnB,YAAQ,IAAIA,OAAM,IAAI,KAAK;AAAA,yBAAuB,CAAC;AACnD,YAAQ,IAAIA,OAAM,KAAK,KAAK,WAAW,cAAc,aAAa;AAAA,CAAe,CAAC;AAClF,YAAQ,KAAK,CAAC;AAAA,EAChB,WAAW,gBAAgB,GAAG;AAC5B,YAAQ,IAAIA,OAAM,OAAO,KAAK;AAAA,uCAAqC,CAAC;AACpE,YAAQ,IAAIA,OAAM,KAAK,KAAK,aAAa;AAAA,CAAe,CAAC;AAAA,EAC3D,OAAO;AACL,YAAQ,IAAIA,OAAM,MAAM,KAAK;AAAA;AAAA,CAA8B,CAAC;AAAA,EAC9D;AACF;AAEA,eAAe,kBAAkB,KAAa,eAAkD;AAC9F,QAAM,SAA2B;AAAA,IAC/B,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,UAAU,CAAC;AAAA,EACb;AAGA,QAAM,oBAAoB;AAAA,IACxBD,MAAK,KAAK,iCAAiC;AAAA,IAC3CA,MAAK,KAAK,uDAAuD;AAAA,EACnE;AAEA,MAAI,mBAAkC;AACtC,aAAW,KAAK,mBAAmB;AACjC,QAAID,YAAW,CAAC,GAAG;AACjB,yBAAmB;AACnB;AAAA,IACF;AAAA,EACF;AAEA,MAAI,kBAAkB;AACpB,QAAI;AACF,YAAM,WAAW,iBAAiB,SAAS,KAAK;AAChD,YAAM,UAAU,WAAW,QAAQ,gBAAgB,KAAK;AAExD,YAAM,SAAS,SAAS,GAAG,OAAO,mCAAmC,aAAa,SAAS;AAAA,QACzF;AAAA,QACA,UAAU;AAAA,MACZ,CAAC;AAGD,YAAM,cAAc,OAAO,MAAM,iBAAiB;AAClD,YAAM,gBAAgB,OAAO,MAAM,mBAAmB;AAEtD,aAAO,SAAS,cAAc,SAAS,YAAY,CAAC,GAAG,EAAE,IAAI;AAC7D,aAAO,WAAW,gBAAgB,SAAS,cAAc,CAAC,GAAG,EAAE,IAAI;AAGnE,YAAM,aAAa,OAAO,MAAM,qBAAqB;AACrD,YAAM,eAAe,OAAO,MAAM,uBAAuB;AAEzD,UAAI,YAAY;AACd,eAAO,SAAS,KAAK,GAAG,WAAW,IAAI,OAAK,EAAE,QAAQ,kBAAkB,EAAE,CAAC,CAAC;AAAA,MAC9E;AACA,UAAI,cAAc;AAChB,eAAO,SAAS,KAAK,GAAG,aAAa,IAAI,OAAK,EAAE,QAAQ,oBAAoB,EAAE,CAAC,CAAC;AAAA,MAClF;AAAA,IACF,SAAS,OAAY;AACnB,YAAM,SAAS,MAAM,UAAU,MAAM,UAAU;AAC/C,YAAM,cAAc,OAAO,MAAM,iBAAiB;AAClD,YAAM,gBAAgB,OAAO,MAAM,mBAAmB;AAEtD,aAAO,SAAS,cAAc,SAAS,YAAY,CAAC,GAAG,EAAE,IAAI;AAC7D,aAAO,WAAW,gBAAgB,SAAS,cAAc,CAAC,GAAG,EAAE,IAAI;AAEnE,YAAM,aAAa,OAAO,MAAM,qBAAqB;AACrD,UAAI,YAAY;AACd,eAAO,SAAS,KAAK,GAAG,WAAW,IAAI,CAAC,MAAc,EAAE,QAAQ,kBAAkB,EAAE,CAAC,CAAC;AAAA,MACxF;AAAA,IACF;AAAA,EACF,OAAO;AAEL,UAAM,UAAUC,MAAK,KAAK,MAAM;AAChC,QAAI,CAACD,YAAW,OAAO,GAAG;AACxB,aAAO;AACP,aAAO,SAAS,KAAK,2BAA2B;AAAA,IAClD;AAEA,UAAM,aAAaC,MAAK,SAAS,WAAW;AAC5C,QAAID,YAAW,OAAO,KAAK,CAACA,YAAW,UAAU,GAAG;AAClD,aAAO;AACP,aAAO,SAAS,KAAK,0BAA0B;AAAA,IACjD;AAAA,EACF;AAEA,SAAO;AACT;AAEA,eAAe,gBAAgB,KAAwC;AACrE,QAAM,SAA2B;AAAA,IAC/B,UAAU;AAAA,IACV,QAAQ;AAAA,IACR,UAAU;AAAA,IACV,UAAU,CAAC;AAAA,EACb;AAEA,QAAM,UAAUC,MAAK,KAAK,MAAM;AAChC,MAAI,CAACD,YAAW,OAAO,GAAG;AACxB,WAAO;AAAA,EACT;AAGA,QAAM,WAAW,CAAC,QAAgB;AAChC,QAAI;AACF,YAAM,QAAQ,YAAY,KAAK,EAAE,eAAe,KAAK,CAAC;AACtD,iBAAW,QAAQ,OAAO;AACxB,cAAM,WAAWC,MAAK,KAAK,KAAK,IAAI;AACpC,YAAI,KAAK,YAAY,GAAG;AACtB,mBAAS,QAAQ;AAAA,QACnB,WAAW,QAAQ,KAAK,IAAI,MAAM,OAAO;AACvC,gBAAM,UAAU,aAAa,UAAU,MAAM;AAC7C,gBAAM,eAAe,SAAS,QAAQ,MAAM,KAAK,EAAE;AAGnD,cAAI,CAAC,QAAQ,MAAM,QAAQ,GAAG;AAC5B,mBAAO;AACP,mBAAO,SAAS,KAAK,GAAG,YAAY,yBAAyB;AAAA,UAC/D;AAGA,cAAI,QAAQ,KAAK,EAAE,WAAW,GAAG;AAC/B,mBAAO;AACP,mBAAO,SAAS,KAAK,GAAG,YAAY,cAAc;AAAA,UACpD;AAGA,gBAAM,cAAc;AACpB,cAAI;AACJ,kBAAQ,QAAQ,YAAY,KAAK,OAAO,OAAO,MAAM;AACnD,kBAAM,WAAW,MAAM,CAAC;AACxB,gBAAI,CAAC,SAAS,WAAW,MAAM,KAAK,CAAC,SAAS,WAAW,GAAG,GAAG;AAC7D,oBAAM,eAAeA,MAAK,KAAK,QAAQ;AACvC,kBAAI,CAACD,YAAW,YAAY,GAAG;AAC7B,uBAAO;AACP,uBAAO,SAAS,KAAK,GAAG,YAAY,oBAAoB,QAAQ,EAAE;AAAA,cACpE;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAAA,IACF,QAAQ;AAAA,IAER;AAAA,EACF;AAEA,WAAS,OAAO;AAEhB,SAAO;AACT;;;AChPA,SAAS,cAAAI,aAAY,gBAAAC,eAAc,gBAAgB;AACnD,SAAS,QAAAC,aAAY;AACrB,OAAOC,YAAW;AAElB,eAAsB,gBAA+B;AACnD,QAAM,MAAM,QAAQ,IAAI;AAExB,UAAQ,IAAIA,OAAM,KAAK,gBAAgB,CAAC;AAGxC,QAAM,aAAaD,MAAK,KAAK,iBAAiB;AAC9C,QAAM,gBAAgBF,YAAW,UAAU;AAE3C,MAAI,CAAC,eAAe;AAClB,YAAQ,IAAIG,OAAM,OAAO,iDAA4C,CAAC;AACtE,YAAQ,IAAIA,OAAM,KAAK,oCAAoC,CAAC;AAC5D;AAAA,EACF;AAEA,UAAQ,IAAIA,OAAM,MAAM,0BAAqB,CAAC;AAG9C,MAAI;AACF,UAAM,gBAAgBF,cAAa,YAAY,MAAM;AACrD,UAAM,eAAe,cAAc,MAAM,iCAAiC;AAC1E,UAAM,YAAY,cAAc,MAAM,8BAA8B;AAEpE,YAAQ,IAAIE,OAAM,KAAK,gBAAgB,CAAC;AACxC,YAAQ,IAAIA,OAAM,KAAK,cAAc,YAAY,CAAC,KAAK,SAAS,EAAE,CAAC;AACnE,YAAQ,IAAIA,OAAM,KAAK,cAAc,eAAe,CAAC,KAAK,SAAS,EAAE,CAAC;AACtE,YAAQ,IAAIA,OAAM,KAAK,cAAc,UAAU,EAAE,CAAC;AAClD,YAAQ,IAAI,EAAE;AAAA,EAChB,QAAQ;AACN,YAAQ,IAAIA,OAAM,OAAO,mCAAmC,CAAC;AAAA,EAC/D;AAGA,QAAM,WAAWD,MAAK,KAAK,gBAAgB;AAC3C,QAAM,gBAAgBA,MAAK,UAAU,gBAAgB;AACrD,QAAM,oBAAoBF,YAAW,aAAa;AAElD,UAAQ,IAAIG,OAAM,KAAK,eAAe,CAAC;AACvC,MAAI,mBAAmB;AACrB,UAAM,QAAQ,SAAS,aAAa;AACpC,UAAM,YAAY,MAAM,MAAM,eAAe;AAC7C,YAAQ,IAAIA,OAAM,MAAM,kCAA6B,CAAC;AACtD,YAAQ,IAAIA,OAAM,KAAK,mBAAmB,SAAS,EAAE,CAAC;AAAA,EACxD,OAAO;AACL,YAAQ,IAAIA,OAAM,OAAO,mCAA8B,CAAC;AACxD,YAAQ,IAAIA,OAAM,KAAK,mCAAmC,CAAC;AAAA,EAC7D;AACA,UAAQ,IAAI,EAAE;AAGd,QAAM,UAAUD,MAAK,KAAK,MAAM;AAChC,QAAM,aAAaF,YAAW,OAAO;AAErC,UAAQ,IAAIG,OAAM,KAAK,gBAAgB,CAAC;AACxC,MAAI,YAAY;AACd,UAAM,aAAaD,MAAK,SAAS,WAAW;AAC5C,UAAM,YAAYF,YAAW,UAAU;AAEvC,YAAQ,IAAIG,OAAM,MAAM,iCAA4B,CAAC;AACrD,YAAQ,IAAI,YACRA,OAAM,MAAM,iCAA4B,IACxCA,OAAM,OAAO,iCAA4B,CAAC;AAG9C,UAAM,eAAeD,MAAK,SAAS,WAAW;AAC9C,QAAIF,YAAW,YAAY,GAAG;AAC5B,YAAM,OAAOA,YAAWE,MAAK,cAAc,SAAS,CAAC;AACrD,YAAM,SAASF,YAAWE,MAAK,cAAc,WAAW,CAAC;AACzD,YAAM,YAAYF,YAAWE,MAAK,cAAc,cAAc,CAAC;AAE/D,cAAQ,IAAIC,OAAM,KAAK,cAAc,CAAC;AACtC,cAAQ,IAAI,OACRA,OAAM,MAAM,oBAAe,IAC3BA,OAAM,KAAK,yBAAyB,CAAC;AACzC,cAAQ,IAAI,SACRA,OAAM,MAAM,sBAAiB,IAC7BA,OAAM,KAAK,2BAA2B,CAAC;AAC3C,cAAQ,IAAI,YACRA,OAAM,MAAM,yBAAoB,IAChCA,OAAM,KAAK,8BAA8B,CAAC;AAAA,IAChD;AAAA,EACF,OAAO;AACL,YAAQ,IAAIA,OAAM,OAAO,oCAA+B,CAAC;AAAA,EAC3D;AACA,UAAQ,IAAI,EAAE;AAGd,QAAM,aAAaD,MAAK,KAAK,WAAW;AACxC,QAAM,cAAcF,YAAW,UAAU;AAEzC,UAAQ,IAAIG,OAAM,KAAK,iBAAiB,CAAC;AACzC,UAAQ,IAAI,cACRA,OAAM,MAAM,4BAAuB,IACnCA,OAAM,KAAK,oCAAoC,CAAC;AACpD,UAAQ,IAAI,EAAE;AAGd,UAAQ,IAAIA,OAAM,KAAK,SAAI,OAAO,EAAE,CAAC,CAAC;AACtC,UAAQ,IAAIA,OAAM,KAAK,iDAAiD,CAAC;AAC3E;","names":["existsSync","join","chalk","buildCommand","existsSync","readFileSync","join","chalk"]}