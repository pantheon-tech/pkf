/**
 * PKF Init Rollback Manager
 * Provides rollback functionality to restore from backups and reverse migrations
 */
import type { WorkflowStateManager } from '../state/workflow-state.js';
import type { LoadedConfig, MigrationOperation } from '../types/index.js';
/**
 * Result of a rollback operation
 */
export interface RollbackResult {
    /** Whether rollback succeeded */
    success: boolean;
    /** List of files that were removed */
    removedFiles: string[];
    /** List of files that were restored */
    restoredFiles: string[];
    /** List of files that were moved back to original locations */
    movedBack: string[];
    /** Number of operations rolled back */
    operationsRolledBack: number;
    /** Error message if rollback failed */
    error?: string;
}
/**
 * RollbackManager handles reverting PKF initialization changes
 */
export declare class RollbackManager {
    private config;
    private stateManager;
    /**
     * Create a new RollbackManager
     * @param config - Loaded configuration
     * @param stateManager - Workflow state manager
     */
    constructor(config: LoadedConfig, stateManager: WorkflowStateManager);
    /**
     * Perform rollback operation using backup
     * @param backupPath - Path to backup directory
     * @returns Rollback result
     */
    rollback(backupPath: string): Promise<RollbackResult>;
    /**
     * Rollback migration operations in reverse order
     * This reverses the effects of file moves, writes, and deletes
     *
     * @param operations - List of operations to rollback (in original order)
     * @param backupPath - Optional backup path for content restoration
     * @returns Rollback result
     */
    rollbackOperations(operations: MigrationOperation[], backupPath?: string): Promise<RollbackResult>;
    /**
     * Move a file back to its original location
     * @param currentPath - Current file path
     * @param originalPath - Original file path
     * @returns True if move was successful
     */
    private moveFileBack;
    /**
     * Restore a single file from backup
     * @param filePath - Relative file path
     * @param backupPath - Path to backup directory
     * @returns True if file was restored
     */
    private restoreFileFromBackup;
    /**
     * Verify that backup exists and is valid
     * @param backupPath - Path to backup directory
     * @returns True if backup exists and is valid
     */
    private verifyBackup;
    /**
     * Remove files and directories generated by PKF
     * @returns List of removed file/directory paths
     */
    private removeGeneratedFiles;
    /**
     * Remove a single file
     * @param filePath - Path to file
     * @returns True if file was removed
     */
    private removeFile;
    /**
     * Remove a directory and all its contents
     * @param dirPath - Path to directory
     * @returns True if directory was removed
     */
    private removeDirectory;
    /**
     * Remove an empty directory only
     * @param dirPath - Path to directory
     * @returns True if directory was removed
     */
    private removeEmptyDirectory;
    /**
     * Restore files from backup to original locations
     * @param backupPath - Path to backup directory
     * @returns List of restored file paths
     */
    private restoreFromBackup;
    /**
     * Recursively copy a directory
     * @param src - Source directory
     * @param dest - Destination directory
     * @param restored - Array to track restored files
     */
    private copyDirectory;
    /**
     * Get the latest backup path if available
     * @returns Latest backup path or null if none found
     */
    getLatestBackup(): Promise<string | null>;
    /**
     * List all available backups
     * @returns List of backup paths with timestamps
     */
    listBackups(): Promise<Array<{
        path: string;
        timestamp: string;
    }>>;
}
export default RollbackManager;
//# sourceMappingURL=rollback.d.ts.map